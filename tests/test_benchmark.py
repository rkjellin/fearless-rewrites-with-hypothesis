from datetime import date

from frwh.legacy import calculate_relative_change
from frwh.rewrite import calculate_relative_change_rewrite

test_data = {
    date(2000, 1, 9): 62.82924732955756,
    date(2000, 2, 18): 64.39447975322993,
    date(2000, 2, 24): 66.34386491511908,
    date(2000, 4, 21): 76.84912615291657,
    date(2000, 7, 7): 94.41320795561793,
    date(2000, 7, 26): 97.84679504716573,
    date(2000, 12, 30): 109.17635548524905,
    date(2001, 2, 21): 131.2189055293886,
    date(2001, 3, 13): 132.93635242903304,
    date(2001, 4, 23): 141.64607742754689,
    date(2001, 6, 12): 142.0588970569908,
    date(2001, 6, 21): 154.28831956201455,
    date(2001, 7, 22): 168.93595456088676,
    date(2001, 10, 12): 179.52746201056857,
    date(2001, 10, 23): 179.00318429717444,
    date(2002, 6, 16): 181.565547429818,
    date(2003, 4, 5): 184.89345579082882,
    date(2003, 4, 6): 197.15718083048554,
    date(2003, 6, 7): 218.11478867184678,
    date(2003, 7, 31): 231.25994010410903,
    date(2003, 8, 10): 241.81244962544972,
    date(2003, 8, 11): 246.31259083005205,
    date(2003, 8, 13): 267.75457991927607,
    date(2003, 8, 14): 132.0,
    date(2003, 8, 20): 94.0,
    date(2003, 8, 21): 93.0,
    date(2004, 6, 25): 92.0,
    date(2004, 6, 29): 91.0,
    date(2005, 1, 16): 90.0,
    date(2005, 12, 28): 89.0,
    date(2006, 11, 29): 88.0,
    date(2007, 8, 28): 87.0,
    date(2007, 11, 18): 86.0,
    date(2007, 12, 26): 85.0,
    date(2008, 12, 19): 84.0,
    date(2008, 12, 31): 83.0,
    date(2009, 11, 23): 82.0,
    date(2014, 8, 19): 81.0,
    date(2014, 11, 24): 80.0,
    date(2015, 6, 21): 79.0,
    date(2000, 1, 4): 78.0,
    date(2000, 1, 23): 77.0,
    date(2000, 2, 2): 76.0,
    date(2000, 2, 10): 75.0,
    date(2000, 2, 27): 74.0,
    date(2000, 3, 25): 73.0,
    date(2000, 4, 10): 72.0,
    date(2000, 6, 7): 71.0,
    date(2000, 6, 16): 70.0,
    date(2000, 6, 30): 69.0,
    date(2000, 7, 20): 68.0,
    date(2000, 7, 23): 67.0,
    date(2000, 8, 15): 66.0,
    date(2000, 8, 16): 50.00000000000001,
    date(2000, 8, 27): 65.0,
    date(2000, 10, 23): 64.0,
    date(2000, 10, 28): 63.0,
    date(2000, 11, 19): 50.000000000000014,
    date(2000, 11, 21): 62.0,
    date(1999, 2, 4): 61.0,
    date(1999, 3, 6): 60.0,
    date(1999, 3, 15): 59.0,
    date(1999, 3, 23): 51.00000000000001,
    date(1999, 4, 28): 57.97207461111007,
    date(1999, 6, 11): 58.0,
    date(1999, 6, 18): 57.0,
    date(1999, 6, 28): 56.0,
    date(1999, 7, 18): 55.0,
    date(1999, 8, 21): 499.0,
    date(1999, 8, 26): 54.0,
    date(1999, 10, 13): 53.0,
    date(1999, 10, 27): 499.99999999999994,
    date(1999, 11, 12): 52.0,
    date(1999, 11, 23): 51.0,
    date(1999, 11, 29): 500.0,
}

d1 = date(2011, 1, 1)
d2 = date(2019, 1, 1)


def test_legacy_benchmark(benchmark):
    benchmark(calculate_relative_change, d1, d2, test_data)


def test_rewrite_benchmark(benchmark):
    benchmark(calculate_relative_change_rewrite, d1, d2, test_data)
